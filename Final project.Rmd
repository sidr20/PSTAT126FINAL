---
title: 'PSTAT 126 Final Project'

output: 
  pdf_document: 
    toc: false 
    number_sections: true 
    includes: null 
    latex_engine: xelatex 
    keep_tex: false 
    pandoc_args: null 
geometry: margin=0.7in
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message =  FALSE)
knitr::opts_chunk$set(warning =  FALSE)
knitr::opts_chunk$set(error =  FALSE)
library(dplyr)
library(knitr)
library(gridExtra)
library(ggplot2)
library(GGally)
dataset <- read.csv("Diamonds Prices2022.csv")
```

:::: callout
::: {style="text-align: center"}
[**STUDENT NAME**]{style="color: blue;"}
:::

-   Miles Reynolds (A051P79)
-   Sid Revanuru (A058P90)
::::

# Part 1: Data Description and Descriptive Statistics #

**1.1**\

**Dataset**\

```{r, echo = FALSE}
head(dataset)
```

**Random Sample**\

```{r, echo = FALSE}
set.seed(29)
head(sample(dataset, 5))
```

**1.2**\

**Summary**\
```{r, echo = FALSE}
summary(dataset)
```

- X\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=x)) +
  geom_histogram() +
  theme_minimal()
```

The distribution for "x" appears to be centered around 6 mm and slightly skewed right. 

- Y\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=y)) +
  geom_histogram() +
  theme_minimal()
```

The distribution for "y" appears to be strongly centered around the 6-8 range, displaying low variance compared to "x".

\newpage
- Z\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=z)) +
  geom_histogram() +
  theme_minimal()
```

The "z" variable is strongly centered around 4 mm, with a slight right skew. 

- Price\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=price)) +
  geom_histogram() +
  theme_minimal()
```

The variable "price" is skewed right, with a mean of a round 2.5k and having a minimum of around 300 with values ranging way up into the ten-thousands.

\newpage
- Table\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=table)) +
  geom_histogram() +
  theme_minimal()
```

The "Table" distribution looks like it is centered around 55-57 with a very slight right skew. It looks to be approximately normally distributed.\

- Depth\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=depth)) +
  geom_histogram() +
  theme_minimal()
```

The "Depth" variable is approximately normally distributed with a a mean around 61-61. Looking at it visually, there doesn't seem to be much of a skew.\

\newpage
- Carat\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=z)) +
  geom_histogram() +
  theme_minimal()
```

The "Carat" variable does not have much of a skew, but is heavily centered around 2-6 carats. Most of the data is concentrated within this range.\

- Cut\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=cut)) +
  geom_bar() +
  theme_minimal()
```

Most cuts appear to be "ideal" and there is more cuts deemed better than ideal than worse than ideal, indicating a slight skew left. 

\newpage
- Color\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=color)) +
  geom_bar() +
  theme_minimal()
```

The diamonds are fairly spread out over each of the colors with "G" accounting for most of the data set.

Clarity\
```{r, echo = FALSE, fig.width = 4, fig.height = 3}
ggplot(dataset, aes(x=clarity)) +
  geom_bar() +
  theme_minimal()
```

In terms of "clarity", most diamonds fall under the "S" category, with SI1 and VS2 accounting for most of the data set.\

**1.3**\

**Correlation**\
```{r, echo = FALSE, fig.width = 6, fig.height = 10}
cor(dataset[, c("carat", "y", "z")])
```

There appears to be a very strong, positive correlation between y, z, and carat. All correlation interactions between the three quantitative variables are above 0.95.

```{r, echo = FALSE}
chisq.test(table(dataset$cut, dataset$clarity))
```
A chi-square test was performed to examine the relationship between "cut" and "clarity", the two categorical variables. The p-value is extremely close to 0, indicating that there is a statistically significant association between "cut" and "clarity".


**1.4**\
**Multiple Linear Regression Model**\

We are choosing *price* as the response variable because logically, price would be most influenced by the other variables in the dataset. 

```{r, echo = FALSE}
model <- lm(dataset$price ~ dataset$y + dataset$z + dataset$carat + dataset$clarity + dataset$cut, data = dataset)
summary(model)
```

**1.5**\

Overall, the multiple linear regression model does not surprise because intuitively, price would be the most influenced by the predictors we chose. We can see that all the predictors are statistically significant. Both the partial and global significance test show that the predictors and the model as a whole are significant. The $R^2$ and adjusted $R^2$ values are very similar which tells us that all the predictors we chose are very useful to the model.\

# Part 2: Simple Linear Regression Model

**2.1**\

$$Y_i = \beta_0 + \beta_1 X_i + \epsilon_i$$
$Y_i: price$\
$X_i: carat$\

**2.2**\

```{r, echo = FALSE}
simple_model <- lm(dataset$price ~ dataset$carat, data = dataset)
summary(simple_model)
```

In this simple linear regression model of $\hat{price} = -2256.40 + 7756.44$(carat), the first thing that we see is that *carat* is statistically significant with a p value that is far less that our standard significance level of $\alpha = .05$, this is the partial significance test. This means that each additional carat increases the expected price by approximately $7,756. The $R^2$ is 0.8493, which is pretty high, telling us that this predictor seems to be useful to the model and is matched by adjusted $R^2$. It explains 84.93% of the variability in *price*. The residual standard error was 1549, indicating the typical prediction error for our model. The global significance test, although not as important in a simple linear regression model, is also significant (p-val close to 0) which further proves that *carat* is a useful predictor for *price*. The confidence interval for $\beta_0$ & $\beta_1$ is given by:\

$$\beta_0: -2256.40 \pm -172.8 *13.05$$\
$$\beta_1: 7756.44 \pm 551.4 * 14.07$$\


